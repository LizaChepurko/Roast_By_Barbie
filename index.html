<!doctype html>
<html lang="he">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HF Space Chat</title>
  <style>
    body{font-family:Arial;max-width:780px;margin:20px auto}
    #chat{border:1px solid #ddd;border-radius:12px;padding:12px;height:420px;overflow:auto}
    .msg{margin:10px 0;padding:10px;border-radius:12px;white-space:pre-wrap}
    .me{background:#e8f1ff;margin-left:80px}
    .bot{background:#f3f3f3;margin-right:80px}
    form{display:flex;gap:8px;margin-top:10px}
    input{flex:1;padding:10px}
    button{padding:10px 14px}
  </style>
</head>
<body>
  <h2>Chat ×¢× ×”××•×“×œ ×©×œ×™ (HF Space)</h2>
  <div id="chat"></div>

  <form id="form">
    <input id="input" placeholder="×›×ª×‘×™ ×”×•×“×¢×”..." autocomplete="off" />
    <button type="submit">×©×œ×™×—×”</button>
  </form>

  <script type="module">
    import { Client } from "https://cdn.jsdelivr.net/npm/@gradio/client/dist/index.min.js";

    // ğŸ” ×”×—×œ×™×¤×™ ×œ×–×”:
    const SPACE_URL = "https://YOUR-SPACE.hf.space";

    const chatEl = document.getElementById("chat");
    const form = document.getElementById("form");
    const input = document.getElementById("input");

    function addMsg(text, who){
      const div = document.createElement("div");
      div.className = `msg ${who}`;
      div.textContent = text;
      chatEl.appendChild(div);
      chatEl.scrollTop = chatEl.scrollHeight;
      return div;
    }

    const client = await Client.connect(SPACE_URL);

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const message = input.value.trim();
      if(!message) return;

      addMsg(message, "me");
      input.value = "";

      const placeholder = addMsg("â€¦", "bot");

      try {
        // âœ… ×‘×’×œ×œ ×©×”×’×“×¨×ª api_name="respond" ×‘-space:
        // ×”××•×¤×¦×™×” ×”×›×™ ×××™× ×”: ×œ×©×œ×•×— ××¢×¨×š ×œ×¤×™ ×¡×“×¨ ×”-inputs
        const result = await client.predict("/respond", [message]);

        // ×‘×“×¨×š ×›×œ×œ result.data ×”×•× ××¢×¨×š, ×•×‘××§×¨×” ×©×œ×š ×™×© output ××—×“:
        const comeback = Array.isArray(result.data) ? result.data[0] : result.data;

        placeholder.textContent = (comeback ?? "").toString().trim() || "(no answer)";
      } catch (err) {
        console.error(err);
        placeholder.textContent = "×©×’×™××” ×‘×§×¨×™××” ×œ-Space (×‘×“×§×™ Console / CORS / ×©×”-Space ×¢×¨).";
      }
    });
  </script>
</body>
</html>
